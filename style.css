:root{
  --bg:#0b1020; --bg2:#151a33; --card:#1e2446; --card2:#1b213d;
  --text:#eef3ff; --muted:#92a0c0; --neon:#00e6ff; --violet:#7c5cff;
  --border:rgba(255,255,255,.08); --shadow:0 10px 30px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;font-family:"Noto Sans TC",system-ui,Arial;
  color:var(--text);background:radial-gradient(1200px 1200px at 20% -10%, #101638 0%, #0b0f22 40%, #070915 70%) fixed,
  linear-gradient(180deg,var(--bg),var(--bg2)) fixed;min-height:100vh}
#particles-bg{position:fixed;inset:0;z-index:-1}

/* nav */
.nav-bar{position:sticky;top:0;z-index:10;display:flex;justify-content:space-between;align-items:center;
  padding:14px 22px;background:rgba(10,13,28,.6);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
.nav-logo h1{margin:0;font-size:18px;letter-spacing:.12em;color:#cfe3ff}
.nav-tabs{display:flex;gap:10px}
.nav-tab{background:transparent;border:1px solid var(--border);color:var(--text);padding:8px 14px;border-radius:999px;cursor:pointer;transition:.2s}
.nav-tab:hover{border-color:rgba(255,255,255,.2);transform:translateY(-1px)}
.nav-tab.active{border-color:var(--neon);box-shadow:0 0 10px rgba(0,230,255,.4), inset 0 0 8px rgba(0,230,255,.25)}

.main-container{max-width:1100px;margin:24px auto 80px;padding:0 16px}
.page{display:none}.page.active{display:block}
.page-header{display:flex;align-items:baseline;justify-content:space-between;margin-bottom:18px}
.page-title{margin:0;font-size:22px;font-weight:700;color:#e8f0ff;text-shadow:0 0 18px rgba(124,92,255,.35)}

/* form */
.input-container{background:rgba(27,33,61,.6);border:1px solid var(--border);border-radius:14px;padding:18px;box-shadow:var(--shadow)}
.input-form{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px;align-items:end}
.input-group{display:flex;flex-direction:column;gap:8px}
.input-label{font-size:13px;color:var(--muted)}
.input-group input,.input-group select{background:#111425;color:var(--text);border:1px solid var(--border);
  padding:10px 12px;border-radius:10px;outline:none;transition:.2s}
.input-group input:focus,.input-group select:focus{border-color:rgba(124,92,255,.6);box-shadow:0 0 0 3px rgba(124,92,255,.15)}
.input-form .nav-tab{height:42px}

/* result */
#bazi-result{background:rgba(27,33,61,.6);border:1px solid var(--border);border-radius:14px;padding:16px 18px;box-shadow:var(--shadow);line-height:1.9}
#bazi-result p{margin:6px 0} #bazi-pillars{font-weight:700}

/* army */
.army-container{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
.army-card{background:linear-gradient(180deg,var(--card) 0%,var(--card2) 100%);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);overflow:hidden;position:relative}
.army-card:before{content:"";position:absolute;inset:0;background:
  radial-gradient(500px 200px at -10% -20%, rgba(0,230,255,.1), transparent 60%),
  radial-gradient(500px 200px at 110% 120%, rgba(124,92,255,.08), transparent 60%)}
.army-card-head{padding:12px 16px;font-weight:700;letter-spacing:.08em;border-bottom:1px solid var(--border);color:#bcd4ff}
.army-card-body{padding:14px 16px 16px}
.army-roles{margin-bottom:10px}
.army-badges{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.badge{background:rgba(124,92,255,.12);border:1px solid rgba(124,92,255,.35);color:#cfc8ff;padding:4px 8px;border-radius:999px;font-size:12px}
.army-advice{color:#dbe8ff;opacity:.9;font-size:13px;margin:8px 0 10px}
.army-story{background:rgba(255,255,255,.03);border:1px dashed var(--border);border-radius:10px;padding:10px 12px;max-height:140px;overflow:auto;line-height:1.75;transition:max-height .25s ease}
.army-story.expanded{max-height:420px}
.story-toggle-btn{margin-top:10px;padding:8px 12px;border:1px solid rgba(0,230,255,.4);background:rgba(0,230,255,.08);
  color:var(--neon);border-radius:10px;cursor:pointer;transition:.2s}
.story-toggle-btn:hover{box-shadow:0 0 14px rgba(0,230,255,.35), inset 0 0 10px rgba(0,230,255,.16)}

/* analysis & wiki */
.analysis-section{background:rgba(27,33,61,.6);border:1px solid var(--border);border-radius:14px;margin-bottom:16px;padding:12px 14px 16px;box-shadow:var(--shadow)}
.analysis-section h3{margin:10px 4px 14px;color:#d7e5ff;font-size:18px}
canvas{width:100% !important;max-height:360px}
#wiki-content{background:rgba(27,33,61,.6);border:1px solid var(--border);border-radius:14px;padding:16px 18px;box-shadow:var(--shadow)}

/* responsive */
@media (max-width: 920px){
  .input-form{grid-template-columns:1fr}
  .army-container{grid-template-columns:1fr}
}